




import os
from pptx import Presentation
from pptx.enum.shapes import MSO_SHAPE_TYPE
from PIL import Image, ImageDraw
import pytesseract

# ğŸ”§ Tesseract ê²½ë¡œ ì„¤ì •
pytesseract.pytesseract.tesseract_cmd = r"C:\Program Files\Tesseract-OCR\tesseract.exe"

# âœ… 1. PowerPoint â†’ ì´ë¯¸ì§€ (í…ìŠ¤íŠ¸ ì¶”ì¶œ ì–´ë ¤ìš´ ìŠ¬ë¼ì´ë“œëŠ” OCR)
def extract_text_from_pptx_ocr(pptx_path, output_txt_path):
    prs = Presentation(pptx_path)
    slide_width = prs.slide_width
    slide_height = prs.slide_height

    texts = []

    for i, slide in enumerate(prs.slides):
        print(f"ğŸ“„ Slide {i+1} ì²˜ë¦¬ ì¤‘...")

        # ì´ë¯¸ì§€ ìº”ë²„ìŠ¤ ë§Œë“¤ê¸°
        img = Image.new('RGB', (slide_width // 9525, slide_height // 9525), 'white')  # EMU â†’ px
        draw = ImageDraw.Draw(img)

        # ìŠ¬ë¼ì´ë“œ ì•ˆì˜ í…ìŠ¤íŠ¸ ìƒì ì¶”ì¶œ
        for shape in slide.shapes:
            if shape.shape_type == MSO_SHAPE_TYPE.TEXT_BOX or shape.has_text_frame:
                text = shape.text.strip()
                draw.text((10, 10 + 20 * len(texts)), text, fill='black')  # ê°„ë‹¨íˆ ë°°ì¹˜
                texts.append(text)

        # OCR ì‹¤í–‰ (í…ìŠ¤íŠ¸ê°€ ë¹„ì–´ìˆëŠ” ê²½ìš°ë‚˜ ì´ë¯¸ì§€ í¬í•¨ ì‹œ)
        extracted_text = pytesseract.image_to_string(img, lang="kor+eng")
        texts.append(f"\n--- [Slide {i+1}] ---\n{extracted_text}")

    # ì €ì¥
    with open(output_txt_path, "w", encoding="utf-8") as f:
        f.write("\n\n".join(texts))

    print(f"âœ… OCR ê²°ê³¼ ì €ì¥ ì™„ë£Œ: {output_txt_path}")
    
if __name__ == "__main__":
    extract_text_from_pptx_ocr(
        pptx_path="../data/pdfs/pdftest.pptx",
        output_txt_path="../data/pdfs/ocr_from_ppt.txt"
    )



RAGê°€ ë¬´ì—‡ì¸ê°€ìš”?


--- [Slide 1] ---
190002




ê°•ì‚¬ë‹˜ ì†Œê°œ

ì„œì§€ì˜ ë‹˜
[ç¾] í•œêµ­ ë§ˆì´í¬ë¡œì†Œí”„íŠ¸ [å‰] í•œêµ­ì€í–‰ ì „ì‚°ì •ë³´êµ­ [å‰] í•œí™”ì‹œìŠ¤í…œICT


--- [Slide 2] ---
oxo
(6) none fo orm oem fo eoICT




01



02



03







CONTENT



04




--- [Slide 3] ---
o2

03

CONTENT

04




ê¸°ì—…ì€ ì™œ ì±—GPT ì„œë¹„ìŠ¤ë¥¼ ì‚¬ìš©í•  ìˆ˜ ì—†ë‚˜?


--- [Slide 4] ---
000901000200000)




ì±—GPT ì„œë¹„ìŠ¤ì˜ ì œì•½


--- [Slide 5] ---
090109




ê°€ ë¬´ì—‡ì¸ê°€ìš”

ê¸°ì—…ì€ ì™œ ì±—GPT ì„œë¹„ìŠ¤ë¥¼ ì‚¬ìš©í•  ìˆ˜ ì—†ë‚˜?
ì±—GPT ì„œë¹„ìŠ¤ì˜ ì œì•½ : ì‚¬ìš©ì ë°ì´í„°ì˜ í•™ìŠµ


--- [Slide 6] ---
000901080200000?
'090109000:0890908




ê°€ ë¬´ì—‡ì¸ê°€ìš”

ê¸°ì—…ì€ ì™œ ì±—GPT ì„œë¹„ìŠ¤ë¥¼ ì‚¬ìš©í•  ìˆ˜ ì—†ë‚˜?
ì±—GPT ì„œë¹„ìŠ¤ì˜ ì œì•½ : ì‚¬ë‚´ ë°ì´í„°ì˜ ì™¸ë¶€ ìœ ì¶œ


--- [Slide 7] ---
00090108020000)
'090129908:0008808


ê°€ ë¬´ì—‡ì¸ê°€ìš”

ê¸°ì—…ì€ ì™œ ì±—GPT ì„œë¹„ìŠ¤ë¥¼ ì‚¬ìš©í•  ìˆ˜ ì—†ë‚˜?
ì±—GPT ì„œë¹„ìŠ¤ì˜ ì œì•½ : ë³´ì•ˆì„±(ì•ˆì •ì„±) ë¬¸ì œ


--- [Slide 8] ---
oom
aecPTammano


ê°€ ë¬´ì—‡ì¸ê°€ìš”

ê¸°ì—…ì€ ì™œ ì±—GPT ì„œë¹„ìŠ¤ë¥¼ ì‚¬ìš©í•  ìˆ˜ ì—†ë‚˜?
ì±—GPT ì„œë¹„ìŠ¤ì˜ ì œì•½ : ë³´ì•ˆì„±(ì•ˆì •ì„±) ë¬¸ì œ



ê¸°ì—… ë‚´ë¶€ë§



í¼ë¸”ë¦­ í´ë¼ìš°ë“œ

OpenAI API
(í•´ì™¸)

ì „ìš©ì„ 

ë§

ì¸í„°ë„· ì—°ê²°


--- [Slide 9] ---




ê¸°ì—…ì—ì„œ ì±—GPTë¥¼ ì•ˆì „í•˜ê²Œ ì‚¬ìš©í•  ìˆ˜ ìˆëŠ” ë°©ë²•ì€?


--- [Slide 10] ---
